local mt = getrawmetatable(game)
if not mt then return end
setreadonly(mt, false)

local old_namecall = mt.__namecall

-- Từ khóa nghi ngờ RemoteEvent/RemoteFunction
local block_keywords = {
    "log", "report", "exploit", "cheat", "suspicious", "data", "security"
}

local function should_block(name)
    name = name:lower()
    for _, keyword in pairs(block_keywords) do
        if name:find(keyword) then
            return true
        end
    end
    return false
end

-- Hook toàn bộ __namecall: xử lý Kick + Remote
mt.__namecall = newcclosure(function(self, ...)
    local method = getnamecallmethod()
    local args = {...}

    -- 🚫 Chặn Kick()
    if method == "Kick" or tostring(method):lower():find("kick") then
        warn("[SEC] Kick blocked")
        return
    end

    if typeof(self) == "Instance" and self:IsA("RemoteEvent") and method == "FireServer" then
        if should_block(self.Name) then
            warn("[SEC] Blocked suspicious RemoteEvent:", self.Name, args)
            return nil
        end
    end

    if typeof(self) == "Instance" and self:IsA("RemoteFunction") and method == "InvokeServer" then
        if should_block(self.Name) then
            warn("[SEC] Blocked suspicious RemoteFunction:", self.Name, args)
            return nil
        end
    end

    return old_namecall(self, unpack(args))
end)

if hookfunction and game:GetService("HttpService") then
    local old_http = hookfunction(game:GetService("HttpService").PostAsync, function(...)
        warn("[SEC] Blocked Http Post")
        return nil
    end)
end
-- Max level, godhuman, cdk, sgt
script_key = "QSHYVAMJTGKIND4A433OF3NFWCQKO" -- premium only, u can leave it blank if ur not
getgenv().Shutdown = false -- Turn on if u are farming bulk accounts
getgenv().Configs = {
    ["Team"] = "Marines",
    ["FPS Boost"] = {
        ["Enable"] = true,
        ["FPS Cap"] = 20,
    },
    ["Farm Boss Drops"] = {
        ["Enable"] = false,
        ["When x2 Exp Expired"] = false
    },
    ["Hop"] = { -- premium only
        ["Enable"] = true,
        ["Hop Find Tushita"] = true,
        ["Hop Find Valkyrie Helm"] = true,
        ["Hop Find Mirror Fractal"] = true,
        ["Hop Find Darkbeard"] = true, -- For skull guitar
        ["Hop Find Soul Reaper"] = true, -- For CDK
        ["Hop Find Mirage"] = true, -- For pull lever
        ["Find Fruit"] = false, -- Will find 1m+ fruit to unlock swan door to access third sea
    },
    ["Farm Mastery"] = {
        ["Enable"] = true,
        ["Farm Mastery Weapons"] = {"Sword", "Gun", "Blox Fruit"}, -- Blox Fruit, Gun (left -> right: High -> Low Priority)
        ["Swords To Farm"] = {"Cursed Dual Katana"},
        ["Guns To Farm"] = {"Skull Guitar"},
        ["Mastery Health (%)"] = 40 -- For Blox Fruit, Gun
    },
    ["Farm Config"] = {
        ["First Farm At Sky"] = true,
        ["Farm Bone Get x2 Exp"] = true
    },
    ["Trackstat"] = {
        ["Enable"] = false,
        ["Key"] = "", -- Get from xerohub.click
        ["Device"] = "test" -- u can put any name here
    },
    ["Auto Spawn rip_indra"] = true,
    ["Auto Spawn Dough King"] = false,
    ["Auto Pull Lever"] = false,
    ["Auto Collect Berry"] = true,
    ["Auto Evo Race"] = true,
    ["Awaken Fruit"] = true,
    ["Rainbow Haki"] = true,
    ["Hop Player Near"] = true,
    ["Skull Guitar"] = true,
    ["Cursed Dual Katana"] = true,
    ["Switch Melee"] = true,
    ["Eat Fruit"] = "Magma Fruit", -- leave blank for none, put the fruit name like this example: Smoke Fruit, T-Rex Fruit, ...
    ["Snipe Fruit"] = "Dough Fruit", -- leave blank for none, put the fruit name like this example: Smoke Fruit, T-Rex Fruit, ...
    ["Lock Fragment"] = 30000,
    ["Buy Stuffs"] = true -- buso, geppo, soru, ken haki, ...
}
repeat random_delay(1, 2) pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/Xero2409/XeroHub/refs/heads/main/kaitun.lua"))() end) until getgenv().Check_Execute
