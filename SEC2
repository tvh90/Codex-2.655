-- ✅ Hàm delay ngẫu nhiên
function random_delay(min, max)
    return task.wait(math.random(min * 100, max * 100) / 100)
end

-- ✅ Spoof HWID & Executor
getgenv().gethwid = function()
    return "LD-HWID-" .. tostring(math.random(10000000, 99999999))
end
getgenv().DeviceID = "LD-DEVICE-" .. tostring(math.random(1000000, 9999999))
getgenv().identifyexecutor = function()
    return "Delta_" .. tostring(math.random(10000, 99999))
end

-- 🛡️ Hook Kick từ __namecall & trực tiếp
local mt = getrawmetatable(game); setreadonly(mt, false)
local old_namecall = mt.__namecall
mt.__namecall = newcclosure(function(self, ...)
    local m = getnamecallmethod()
    if m == "Kick" or tostring(m):lower():find("kick") then
        return warn("[AntiSEC] Blocked Kick (__namecall)")
    end
    return old_namecall(self, ...)
end)
local lp = game:GetService("Players").LocalPlayer
hookfunction(lp.Kick, function(...) return warn("[AntiSEC] Blocked Kick (direct)") end)

-- 🛡️ Hook HttpService (cho phép XeroHub load)
local HttpService = game:GetService("HttpService")
local raw_HttpGet = hookfunction(HttpService.HttpGet, function(self, url, ...)
    if url:lower():find("githubusercontent.com/xero2409") then
        return raw_HttpGet(self, url, ...)
    end
    return warn("[AntiSEC] Blocked HttpGet:", url)
end)
hookfunction(HttpService.HttpPost, function(...) return warn("[AntiSEC] Blocked HttpPost") end)
hookfunction(HttpService.HttpPostAsync, function(...) return warn("[AntiSEC] Blocked HttpPostAsync") end)

-- 🛡️ Hook AnalyticsService
local Analytics = game:GetService("AnalyticsService")
hookfunction(Analytics.FireEvent, function(...) return warn("[AntiSEC] Blocked Analytics Event") end)

-- 🛡️ Hook RemoteEvent & Function đáng nghi
local suspicious = {"log","report","exploit","cheat","suspicious","flag","data","sec","track","monitor"}
local function is_suspicious(n)
    n = tostring(n):lower()
    for _, w in ipairs(suspicious) do if n:find(w) then return true end end
    return false
end
local old_fire = hookfunction(Instance.new("RemoteEvent").FireServer, function(self, ...)
    if is_suspicious(self.Name) then
        return warn("[AntiSEC] Blocked RemoteEvent:", self.Name)
    end
    return old_fire(self, ...)
end)
local old_invoke = hookfunction(Instance.new("RemoteFunction").InvokeServer, function(self, ...)
    if is_suspicious(self.Name) then
        return warn("[AntiSEC] Blocked RemoteFunction:", self.Name)
    end
    return old_invoke(self, ...)
end)

-- 🛡️ Hook Platform / UserSettings
getgenv().getplatform = function() return "Win32" end
getgenv().is_studio = function() return false end
pcall(function()
    local us = UserSettings()
    hookfunction(us.GetService, function(...) return nil end)
end)

-- 🧠 Giả hành vi người dùng
spawn(function()
    local actions = {
        function()
            game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
                {"hi","yo","hello","need help","lol"}[math.random(1,5)], "All"
            )
        end,
        function()
            local cam = workspace.CurrentCamera
            cam.CFrame = cam.CFrame * CFrame.Angles(0, math.rad(math.random(-10,10)), 0)
        end,
        function()
            local gui=Instance.new("ScreenGui",game:GetService("CoreGui"))
            local lab=Instance.new("TextLabel",gui)
            lab.Text="Ping: "..math.random(50,100)
            lab.Size=UDim2.new(0,100,0,20)
            lab.Position=UDim2.new(0,10,0,10)
            task.delay(10,function() gui:Destroy() end)
        end
    }
    while task.wait(math.random(200,500)) do
        pcall(function()
            actions[math.random(1,#actions)]()
        end)
    end
end)

print("[✅ AntiSEC v2025] Protections enabled")
-- Max level, godhuman, cdk, sgt
script_key = "XKH3LMMCTGWJVP54432PZM5HXGYA" -- premium only, u can leave it blank if ur not
getgenv().Shutdown = false -- Turn on if u are farming bulk accounts
getgenv().Configs = {
    ["Team"] = "Marines",
    ["FPS Boost"] = {
        ["Enable"] = true,
        ["FPS Cap"] = 15,
    },
    ["Farm Boss Drops"] = {
        ["Enable"] = false,
        ["When x2 Exp Expired"] = false
    },
    ["Hop"] = { -- premium only
        ["Enable"] = true,
        ["Hop Find Tushita"] = true,
        ["Hop Find Valkyrie Helm"] = true,
        ["Hop Find Mirror Fractal"] = true,
        ["Hop Find Darkbeard"] = true, -- For skull guitar
        ["Hop Find Soul Reaper"] = true, -- For CDK
        ["Hop Find Mirage"] = true, -- For pull lever
        ["Find Fruit"] = true, -- Will find 1m+ fruit to unlock swan door to access third sea
    },
    ["Farm Mastery"] = {
        ["Enable"] = true,
        ["Farm Mastery Weapons"] = {"Sword", "Gun", "Blox Fruit"}, -- Blox Fruit, Gun (left -> right: High -> Low Priority)
        ["Swords To Farm"] = {"Cursed Dual Katana"},
        ["Guns To Farm"] = {"Skull Guitar"},
        ["Mastery Health (%)"] = 40 -- For Blox Fruit, Gun
    },
    ["Farm Config"] = {
        ["First Farm At Sky"] = true,
        ["Farm Bone Get x2 Exp"] = true
    },
    ["Trackstat"] = {
        ["Enable"] = false,
        ["Key"] = "", -- Get from xerohub.click
        ["Device"] = "test" -- u can put any name here
    },
    ["Auto Spawn rip_indra"] = true,
    ["Auto Spawn Dough King"] = true,
    ["Auto Pull Lever"] = true,
    ["Auto Collect Berry"] = true,
    ["Auto Evo Race"] = true,
    ["Awaken Fruit"] = true,
    ["Rainbow Haki"] = true,
    ["Hop Player Near"] = true,
    ["Skull Guitar"] = true,
    ["Cursed Dual Katana"] = true,
    ["Switch Melee"] = true,
    ["Eat Fruit"] = "Magma Fruit", -- leave blank for none, put the fruit name like this example: Smoke Fruit, T-Rex Fruit, ...
    ["Snipe Fruit"] = "Dough Fruit", -- leave blank for none, put the fruit name like this example: Smoke Fruit, T-Rex Fruit, ...
    ["Lock Fragment"] = 30000,
    ["Buy Stuffs"] = true -- buso, geppo, soru, ken haki, ...
}
repeat random_delay(1, 3) pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/Xero2409/XeroHub/refs/heads/main/kaitun.lua"))() end) until getgenv().Check_Execute
